%-------------------------------------------------------------------------------
%-------------------------------------------------------------------------------
%-------------------------------------------------------------------------------
% Дополнительные комманды для данной работы:

\newcommand{\insertFourImages}[4]
{
	\begin{figure}[!htb] %htbp!
		\centering
		\includegraphics[width=0.49\textwidth]{../pics/plan#1.png}
		\includegraphics[width=0.49\textwidth]{../pics/plan#2.png}
		\includegraphics[width=0.49\textwidth]{../pics/plan#3.png}
		\includegraphics[width=0.49\textwidth]{../pics/plan#4.png}
	\end{figure}
}


\newcommand{\insertTable}[1]
{
	s = #1

	\input{../tables/#1}

	\vspace{8mm}
}



%-------------------------------------------------------------------------------
%-------------------------------------------------------------------------------
%-------------------------------------------------------------------------------
\insertTitle{Планирование и анализ эксперимента}{2}{ПМ-63}{Кожекин М.В.}{Майер В.А.}{Назарова Т.А.}{Утюганов Д.С.}{9(1)}{2020}


%-------------------------------------------------------------------------------
\section{Цель работы}
Изучить алгоритмы, используемые при построении непрерывных оптимальных планов эксперимента.


%-------------------------------------------------------------------------------
\section{Задание}

1.	Изучить условия оптимальности планов эксперимента и алгоритмы синтеза непрерывных оптимальных планов эксперимента.

2.	Разработать программу построения непрерывных оптимальных планов эксперимента, реализующую последовательный или комбинированный алгоритм. Применить программу для построения оптимального плана для тестового примера из варианта заданий. Для отчета предусмотреть выдачу на печать протокола решения по итерациям. При большом числе итераций предусмотреть вывод протокола с некоторой дискретностью.

3.	Оформить отчет, включающий в себя постановку задачи, протокол решения, графическое изображение начального плана и полученного оптимального плана, а также текст программы.

4.	Защитить лабораторную работу.


%-------------------------------------------------------------------------------
\section{Анализ}

Задана двухфакторная модель на квадрате [-1, 1].
\[ y = \Theta_0 + \Theta_1 \cdot x_1 + \Theta_2 \cdot x_2 + 
\Theta_3 \cdot x_1 \cdot x_2 + \Theta_4 \cdot x_1^2 + \Theta_5 \cdot x_2^2 \]

Начальный план - полный двухфакторный эксперимент из 25 точек, на уровнях -1, -0.5, 0, +0.5, +1, веса равны 1/25.
Строить D-оптимальные планы. Последовательный алгоритм.


Этапы {\bf последовательного алгоритма} синтеза непрерывного оптимального плана:

1. Выбирается невырожденный начальный план $\varepsilon^0$. Номер итерации s = 0.

2. Отыскивается точка глобального эстремума $x^s$:
\[ x^s = arg \min_{x \in \tilde{X}} \max_{x \in \tilde{X}} \varphi(x, \varepsilon^s), \text{ где } \quad \varphi(x, \varepsilon) = f^T(x) \frac{d\Phi [M(\varepsilon)] }{ dM(\varepsilon) } f(x) \]

3. Проверяется приближенное выполнение необходимых и достаточных условий оптимальности планов
\[ \left| - \min_{x \in \tilde{X}} \max_{x \in \tilde{X}} \varphi(x, \varepsilon^s)
 + tr M(\varepsilon^s)  \frac{d\Phi [M(\varepsilon)] }{ dM(\varepsilon) } \right| \leq \delta,
\text{ где} \quad \delta = \left| \min_{x \in \tilde{X}} \max_{x \in \tilde{X}} \varphi(x, \varepsilon^s) \right| \times 0.01 \]
Если условие выполнено, то работа алгоритма прекращается. В противном случае осуществляется переход на шаг 4.

4. Составляется план
\[ \varepsilon^{s+1} = (1 - \alpha^s) \varepsilon^s + \alpha^s \varepsilon(x^s)\]
где $\alpha \in (0,1)$, $\varepsilon(x^s)$ - план, состоящий из одной точки $x^s$.


5. Величина $\Psi[M(\varepsilon^{s+1})]$ сравнивается с величиной $\Psi[M(\varepsilon^{s})]$:

а) если $\Psi[M(\varepsilon^{s+1})] \geq \Psi[M(\varepsilon^{s})]$, то величина $\alpha^s$ уменьшается в
$\gamma$ раз и повторяются шаги 4-5;

б) если имеет место обратное неравенство, то s замется на s+1 и происходит переход на шаг 2.
\vspace{5mm}



В конце происходит процедура "очистки" плана.

1. Точки, тяготеющие к одной из групп, объединяются по правилу
\[ p_j^s = \sum_k=1^l p_{j_k}^s, x_j^s = 1 / p_j^s \sum_{k=1}^l {x_{j_k}^s p_{j_k}^s} \]

2. Точки с малыми весами, не тяготеющие ни к одной из групп, указанных в 4), выбрасываются.
Их веса распределяются между остальными точками 





%-------------------------------------------------------------------------------
\section{Визуализация работы алгоритма}

На каждой точке спектра плана указан её вес в процентах:
Как видно решение сходится к плану, с координатами точек [-1, 0, 1].

\insertTable{1}

\insertTable{10}

\vspace{10mm}

\insertTable{20}

\insertTable{30}


\insertFourImages{1}{10}{20}{30}

Выход из программы происходит по числу итераций. Как по s, так и по $\alpha$:

> python lab2.py

1 20

2 20

...

29 20

30 20


%-------------------------------------------------------------------------------
\section{Исходный код программы}
\myCodeInput{python}{lab2.py}{../lab2.py}