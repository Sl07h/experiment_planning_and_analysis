%-------------------------------------------------------------------------------
%-------------------------------------------------------------------------------
%-------------------------------------------------------------------------------
\insertTitle{Планирование и анализ эксперимента}{1}{ПМ-63}{Кожекин М.В.}{Майер В.А.}{Назарова Т.А.}{Утюганов Д.С.}{9(1)}{2020}


%-------------------------------------------------------------------------------
\section{Цель работы}
Изучить понятие оптимального плана эксперимента и критерии оптимальности планов.


%-------------------------------------------------------------------------------
\section{Задание}

1.	Изучить понятия непрерывного плана эксперимента и информационной матрицы, а также критерии оптимальности, связанные с точностью оценивания параметров модели и точностью оценивания математического ожидания функции отклика.

2.	Разработать программу по обработке различных планов эксперимента для регрессионных моделей. Обработка заключается в вычислении различных характеристик плана, связанных с тем или иным критерием оптимальности.

3.	Для каждого из планов вычислить значения функционалов от информационной (дисперсионной) матриц, связанных с такими критериями, как: $D-$, $A-$, $E-$, $\Phi_2-$, $\Lambda-$,  $MV-$, $G-$ оптимальности. Проранжировать планы, указанные в варианте, с позиций различных критериев. Выбрать план, наиболее предпочтительный по совокупности критериев. Список планов приведен в табл. 1.

4.	В качестве спектра плана выбрать один из приведенных в табл. 1 для соответствующей модели. Веса точек выразить в виде зависимости от одного параметра, как в примере аналитического построения оптимального плана. Для этого параметра определить допустимые интервалы значений, руководствуясь тем, что веса точек должны быть неотрицательные, а число таких точек с ненулевыми весами должно быть не меньше числа параметров в модели. Построить графики изменения критерия оптимальности плана, указанного в варианте, в зависимости от этого скалярного параметра; определить по графику оптимальные значения параметра и критерия. Сравнить полученный результат с результатами из п. 3.

5.	Оформить отчет, включающий в себя постановку задачи, полученные результаты и текст программы.

6.	Защитить лабораторную работу. 


%-------------------------------------------------------------------------------
\section{Анализ}

В рамках работы исследуется общая линейная модель:
\[ y = f^T(x)\Theta + \varepsilon = \sum_{l=1}^m f_l(x)\Theta_l + \varepsilon \]
\[ y = \Theta_0 + \Theta_1 \cdot x + \Theta_2 \cdot x^2 \]

Исходя из варианта задания (1) эксперимент проводится в трёх точках -1, 0, 1

{\bf Непрерывным нормированным планом} эксперимента называется совокупность величин вида

\[
	\varepsilon^*=
	\begin{bmatrix}
	    x_1		&	x_2		&	\cdots		&	x_n	\\
 	    p_1		&	p_2		&	\cdots		&	p_n
	\end{bmatrix}
	\text{где } \sum_{i=1}^n p_i = 1, p_i \geq 0
\] 

{\bf Информационной матрицей} дискретного непрерывного плана называется величина
\[M = \sum_{j=1}^n p_j f(x_j)f^T(x_j) = \frac{X^T X}{N}\]

Матрица, обратная к информационной, называется {\bf дисперсионной}
\[ D(\varepsilon)=M^{-1}(\varepsilon) \quad D(\varepsilon_N)=M^{-1}(\varepsilon_N) \]

Критерии оптимальности плана эксперимента:
\[ D-\text{оптимальности } \varepsilon^* = Arg \min_{\varepsilon} |D(\varepsilon)| \]
\[ A-\text{оптимальности } \varepsilon^* = Arg \min_{\varepsilon} tr D(\varepsilon) \]
\[ E-\text{оптимальности } \varepsilon^* = Arg \min_{\varepsilon} \max_i \lambda_i[D(\varepsilon)] \]
\[ \Phi_2-\text{оптимальности } \varepsilon^* = Arg \min_{\varepsilon} \sqrt{m^{-1} tr D^2(\varepsilon)} \]
\[ \Lambda-\text{оптимальности } \varepsilon^* = Arg \min_{\varepsilon} \sum_{i=1}^n [ \lambda_j(D(\varepsilon)) - \overline{\lambda}(D(\varepsilon)) ]^2 \]
\[ MV-\text{оптимальности } \varepsilon^* = Arg \min_{\varepsilon} \max_i D_{ii}(\varepsilon) \]
\[ G-\text{оптимальности } \varepsilon^* = Arg \min_{\varepsilon} \max_{x \in \hat{X}} d(x, \varepsilon) \]
\[ d(x, \varepsilon) = f^T(x) M^{-1} f(x) \]


%-------------------------------------------------------------------------------
\section{Выбор оптимального плана}

В каждом из 4 вариантов эксперимент проводится в трёх точках: -1, 0, 1

\( y = \Theta_0 + \Theta_1 \cdot x + \Theta_2 \cdot x^2 \)

\begin{tabular}{|c|c|c|c|}
\hline
	№ & $p_1$ & $p_2$ & $p_3$ \\ 
\hline
	1 & 0.2 & 0.6 & 0.2 \\ 
	2 & 0.25 & 0.5 & 0.25 \\ 
	3 & 0.1884 & 0.6233 & 0.1884 \\ 
	4 & 0.333 & 0.333 & 0.333 \\
\hline
\end{tabular}

Найдём информационные и дисперсионные матрицы для каждого из вариантов:

{\bf Матрицы M:}

\input{matricies_M}

{\bf Матрицы D:}

\input{matricies_D}

\input{plans_comparison}

Исходя из совокупности критериев оптимальным является план из варианта 2.

\[
	\varepsilon^*= \begin{bmatrix}
	-1		&	0		&	1		\\
	0.25	&	0.5		&	0.25
	\end{bmatrix}
\] 


%-------------------------------------------------------------------------------
\section{Выбор оптимального параметра}

Под планом понимается модель из варианта 4 вида:

\[
	\varepsilon^*=
	\begin{bmatrix}
	    -1		& 		 0		 & 		1		\\
 	     q		& 1 - 2\cdot q &		q
	\end{bmatrix}
	q \in (0, 0.5)
\] 


\begin{figure}[!htb] %htbp!
	\centering
	\includegraphics[width=0.5\textwidth]{opt_q.png}
	\caption{Оптимальное значение параметра q = 0.333}
\end{figure}


Проверим решение аналитически:

\[
	M = q \cdot
	\begin{bmatrix}
		 1		\\
		-1		\\
		 1
	\end{bmatrix}
	\cdot
	\begin{bmatrix}
	    1 & -1 & 1
	\end{bmatrix}
	+ (1 - 2\cdot q) \cdot
	\begin{bmatrix}
		1		\\
		0		\\
		0
	\end{bmatrix}
	\cdot
	\begin{bmatrix}
	    1 & 0 & 0
	\end{bmatrix}
	+ q \cdot
	\begin{bmatrix}
		1		\\
		1		\\
		1
	\end{bmatrix}
	\cdot
	\begin{bmatrix}
	    1 & 1 & 1
	\end{bmatrix}
\]


\[
	M = q \cdot
	\begin{bmatrix}
		 1		&	 -1		&		1	\\
		-1		&	  1		&     -1	\\
		 1		&	 -1		&		1
	\end{bmatrix}
	+ (1 - 2\cdot q) \cdot
	\begin{bmatrix}
		 1		&	  0		&		0	\\
		 0		&	  0		&      0	\\
		 0		&	  0		&		0
	\end{bmatrix}
	+ q \cdot
	\begin{bmatrix}
		 1		&	  1		&		1	\\
		 1		&	  1		&      1	\\
		 1		&	  1		&		1
	\end{bmatrix}
\]

\[
	det(M) =
	\begin{bmatrix}
		 1		&	  0		&	   2q	\\
		 0		&	 2q		&		0	\\
		2q		&	  0		&	   2q
	\end{bmatrix}
	= 4q^2 + 0 + 0 - 8q^3 - 0 - 0
	= 4q^2 - 8q^3
\]
\[ \frac{d(|M|)}{dq} = 4 \cdot 2 q - 8 \cdot 3 q^2 = 0 \]
\[ \frac{d(|M|)}{dq} = 3 q^2 - q = 0 \]
\[ \text{Аналитическое значение параметра } q = \frac{1}{3} \]


%-------------------------------------------------------------------------------
\section{Исходный код программы}
\myCodeInput{python}{lab1.py}{../lab1.py}